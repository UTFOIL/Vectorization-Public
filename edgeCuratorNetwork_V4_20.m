function [Y,Xf,Af] = edgeCuratorNetwork_V4_20(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 16-Dec-2019 16:52:31.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx12 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx1 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0;5.30748906995243e-12;-1.25895744581426e-07;-1.40346853781958e-07;-1.18813012698623e-07;-1.40346853781958e-07;-1.15336504930302e-07;-1.12216976099339e-07;-1.18813012698623e-07;-1.12216976099339e-07;-5.91420927881365e-08;-0.957084335496851];
x1_step1.gain = [0.10307418619731;5220393.30213686;12102169.9620964;9391416.67660819;9308429.95850305;9391416.67660819;13372298.6843264;9541846.60886222;9308429.95850305;9541846.60886222;11564993.490665;0.144983000683284];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.7925685511788669313;-1.5703030966662956391;0.037886544970353763784;-0.074193629360036011944;1.0948764528509151717;-0.65561043613117897522;-0.49205125557882573029;-0.22853656600945310151;-0.23855302010615753172;1.1442736685425165533;0.072174850417566938088;-0.25174509664037647561;-0.0093414552339702808942;-0.80398027579128605868;1.6144414700723479505;-2.0334904639243367441;1.3361371360386637974;-1.3792522015868853291;1.0068724079261546223;-1.6507935624485163828];
IW1_1 = [0.51403765680433322061 0.0069825270651625919935 0.167230407330492159 -0.3620492319834813788 -0.9533117285453676093 -0.28553655109254977296 -0.49405030524862247887 0.47146809428611519133 0.60043146363302535296 -0.13406118768418051612 0.57767618026886091709 0.7928084458848139171;0.62397869723639565187 0.38382001201086718423 0.12739287680935967861 0.072248756059028279575 0.58547278297872573649 0.039916708249616378312 -0.1796725640183128303 -0.65494614067741574459 0.07334854423811149049 -0.66370144177321155343 -1.0092971980936236154 0.60556134607163036865;-4.6126983890947883538 1.8399858689048804727 -0.62143191579594769802 -0.90812497305003858639 0.31451498990282089618 -0.54633455000787956024 -1.9476490157540882198 0.17497924651095816961 -0.40026849624029803287 0.50911172602166421264 1.4748098963207261214 0.42210535355435030436;-3.2142155474080151834 1.9248511364089637699 -1.4226172918023944902 -0.22603978453223785849 0.40325685496408436581 -1.0391860680352147384 -1.7350664732848983807 -0.59150139402791157561 0.51194145908930466238 0.63937040810177347971 1.0651526490076346221 0.57882736249233357473;-0.36018192654844677358 0.061607993444482873902 0.49842851626913958762 -0.46632906580374683392 -0.85740685610551536922 -0.51407689848965365531 0.8675714447464717427 -0.26966279218720906607 0.78182660579040408333 -0.12389267320115687765 -0.0060793474873929173943 -0.38537992699295242627;-0.98624099512264318257 -0.8553795335571693359 0.35677409212703942165 0.37879016512836682917 -0.1899131004666050615 -0.68220279367931790926 0.70811473982765960056 0.25858291517998982512 0.1106848743635649307 -0.76990454783831452357 0.24400176984048252415 0.18832344667213501976;-0.90193288567579443793 -0.83070688211268839396 -0.43264552430769348534 0.46494163886046330214 -0.49415575595117144925 -0.59541622301097896219 -0.088956084130880533345 0.59440099483253006074 0.26674987863647386943 -0.50132829086431962562 -0.44514204239193833068 -0.91104457287422446754;0.67427342317459182386 -0.71295423361207388435 0.2822840433997043097 0.57956221155565612602 0.63636298690428105829 -0.45228495468014640046 -0.74614778637051704102 -0.83280789235221985845 0.20383960483976221179 -0.16766101954798587337 -0.17847257412253453301 0.32133063567397235349;0.49493468416337993432 1.0342599227860456157 -0.79937651952166788316 -0.26085777808720167492 -0.1640180319308069401 -0.3184382881151628375 -0.48268484081038759426 0.70971102376031613979 -0.5510744764166392029 0.1308869441124585753 0.85550053406163584224 -0.2660721961521591572;1.7167700819705487003 -1.6816631837472368893 0.19426498834504749014 -0.32740605954016599455 0.85542386879903042907 -0.38716125367468035012 0.78740906469170546256 0.5759450772644255645 -0.21036904883430843083 -0.32212600901313342971 -0.51660370553534196159 -0.48280791493418306892;-2.0578033477946640062 0.80281995164920338937 -0.35198182259892635271 -0.62304373835364212919 -0.77941729577029417175 0.97237318568982888944 0.26955943413071337122 -0.03801683680925182357 -0.094883437769384224025 0.23679346765770714622 0.31180911105168646058 -0.039679055153648057352;1.1714469563359581894 -0.52376947303380239074 0.88250792670754285574 0.69228371453310166839 -0.37734919031211888729 0.74413199652357198133 -0.31005319364451827679 -0.095974256336211885565 -0.43227199839696234251 0.35798044355679914386 -0.69446093454200319428 0.65889976326840216103;-1.5677285037140491486 0.21828231766473998876 0.89752863993767029172 -0.41615999218582594432 -0.52991377931524286105 0.13490182737074152275 -0.54957779858692723529 -0.055606609386975980325 0.60769687698970697998 -0.42197118651409609713 -0.12658424115834579493 0.15843446961136317674;0.50939032944061068964 -0.16915917701116081617 -0.62951467956722184649 0.5413324316733978403 -0.66642982285684415622 -0.074923294441309642999 -0.53551037528385980746 -0.3519804423640349178 -0.55895681981136724481 -0.69791821150071597923 0.20404679040190176753 0.81873333321107866212;-0.24688206784249264181 -1.276764714832601566 0.28195221501427542021 0.33147547185000481029 0.81179781952078833296 -0.072604562092349417268 0.39171237503565642379 0.068709682159101781451 -0.48403122740407572566 -0.35794821326083503532 0.25251375748854842929 0.23288011787858456381;-3.4401080699098169902 0.37143644832183125848 -1.0085072695046817248 0.73521485971430033945 0.045116991297830894014 0.53374460489149000431 -0.54410426756328922338 -0.052351524284829975553 -0.81250052402937644747 -0.45493875507051462215 0.40415121132552689343 0.24985147124590806333;0.86179632653699655975 0.16641358591861771243 -0.90468631878593119833 -0.86691233651256027759 0.12100950472906153721 -0.24885479081999581363 0.45455147994858835503 0.68350357880928758192 -0.56313778927975288724 -0.15196713925450044957 -0.37220424839311699872 0.35123402481850707346;-0.64266671516551177046 -0.10777868678744019493 -0.29490093083628854398 -0.1012469072522012431 -0.70586007511825754612 -0.76431895806932981241 -0.062172014104426499836 0.5922301747883893519 -0.1242661526393343957 0.018179136328933764161 0.96066850825704452888 -0.61943803214446435668;3.5880449826248934642 0.34568257506619376462 -0.53601546988969461793 -0.84124118580503459697 0.51881923447316868891 0.25386890698922892629 0.12436948795604668705 0.19634058102988416472 -0.36222641703037850025 -0.71213731754877018787 -0.77353733496951082582 -0.68114324464442888019;-0.70323604907982906198 0.44998771275422344562 0.58443883446217903543 0.88031077747565378289 0.23568569241936448977 -0.14979225349438621273 -0.31521320940187547155 -0.20918448587905572045 0.77818377316515541242 -0.41825727176888738423 0.66254091198608455748 0.36362387737595075476];

% Layer 2
b2 = -0.043397121777519850894;
LW2_1 = [0.030230060764048844596 -0.083584217495348570037 5.1855722108594228814 3.8362031652778671997 0.10461334228284784043 0.70921986154581506678 0.30593798887182754864 -0.58665615332096399115 0.17619220984392069962 -2.1776356444301554482 2.6170332570543295425 -1.1068188135242162939 1.4889965411639678461 -0.57887754201929630948 0.45361850420946087104 3.6395231324508672266 -0.84725677816653632846 0.69575267665246764981 -3.6163246267632529474 0.70411477142229994541];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n,~)
a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
